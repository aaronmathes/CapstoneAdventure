@using Capstone_Xavier.Models

@model List<CharacterModel>

@{
    ViewBag.Title = "User";
}


<h2>@ViewData["Title"]</h2>

<div class="nav-side">
    <div class="dropdown">
        <button onclick="dropDown()" class="dropBtn">More</button>
        <div id="myDropdown" class="dropdown-item">
            <a onclick="location.href='@Url.Action("UserInfo", "User")'">Profile</a>
            @{
                string role = Session["Role"].ToString();

                if (role == "1")
                {
                    <a onclick="location.href='@Url.Action("Admin", "Admin")'">Admin</a>
                }
                else if (role == "3")
                {
                    <a onclick="location.href='@Url.Action("Gamemaster", "Admin")'">GameMaster</a>
                }
            }
            @*<a>@Html.ActionLink("FAQS", "FAQS", "Home")</a>*@
            <a onclick="location.href='@Url.Action("Logout", "Home")'">Logout</a> @*this makes no extra spaces while @Html.ActionLink creates spaces*@
        </div>
    </div>
</div>
<br>


<div class="list">

    @for (int i =0; i < Model.Count; i++)
    {
        <div id="@Model[i].id">
            <div class="row" style="margin-right: 0px; margin-left: 0px;">
                <div class="col-sm-6">
                    <div class="list-item-character">
                        <p onclick="location.href='@Url.Action("Game", "Game", Model[i])'" style="cursor: pointer">@Model[i].name</p>
                        <h6 class="sub-num">@Model[i].level</h6>
                        <button class="btn-change" id="@Model[i].id" onclick="location.href='@Url.Action("UpdateCharacter", "User", Model[i])'"></button>
                        <button class="btn-remove" id="CharacterRemoveButton" onclick="DeleteCharacterAlert('@Model[i].name', '@Model[i].id')"></button> @*onclick="location.href='@Url.Action("RemoveCharacter", "User", ch)'*@
                        @*var i = ;*@
                        @*<button onclick="location.href='@Url.Action("RemoveCharacter", "User", i)'"></button>*@

                    </div>
                    <div class="row" style="margin-right: 0px; margin-left: 0px;">
                        <div class="info" style="margin-left: 2%;">@Model[i].className</div>
                    </div>
                </div>
                <div class="col-sm-6">
                    <div class="info">
                        Health: @Model[i].health / @Model[i].maxHP
                        <br>
                        Xp: @Model[i].xp / @Model[i].maxXp
                        <br>
                        Gold: @Model[i].gold
                    </div>
                </div>
            </div>
            <hr>
        </div>
        
        
    }
</div>

<div id="deleteAlert" style="display: none; position: fixed; right: 40vw; top: 17vw; font-size: 1.5rem; width: fit-content; padding: 2%; background-color: palegoldenrod; background-image: linear-gradient(#ee3f3f, #961111); border-radius: 12px; ">
    
</div>

<div>
    <button class="btn-user" id="User" onclick="location.href='@Url.Action("createCharacter", "User", null)'">Create Character</button>
    <label style="position: absolute; top:20vw; right:25vw;">Click the character name to play!</label>
</div>

<script type="text/javascript">
    function DeleteCharacterAlert(name, id) {
        $.ajax({
            url: "../../User/DeleteAlert",
            type: "Post",
            data: { name: name, id: id},
            cache: false,
            async: true,
            success: function (data) {
                var alert = document.getElementById("deleteAlert");
                /*console.log("deleteAlert");*/
                alert.style.display = "inline-block";
                alert.innerHTML = data;
                console.log(data);
            }
        });

    }

    function cancelDelete() {
        var alert = document.getElementById("deleteAlert");
        console.log(alert.innerHTML);
        alert.style.display = "none";

    }
    function removeCharacter(id) {
        console.log(id);
        //<!--var button = document.getElementById("delete");
        //var id = charId;
         @*button.onclick = "location.href='@Url.Action("RemoveCharacter", "User", Model[id] )'"-->*@ 
        @*button.onclick = "location.href='@Url.Action("RemoveCharacter", "User", cha )'"*@

        $.ajax({
            url: "../../User/RemoveCharacter",
            type: "Post",
            data: { characterId: id },
            cache: false,
            async: true,
            success: function (data) {
                console.log(id);
                var list = document.getElementById(data);
                list.style.display = "none";
                var alert = document.getElementById("deleteAlert");
                alert.style.display = "none";
                //var alert = document.getElementById("deleteAlert");
                ///*console.log("deleteAlert");*/
                //alert.style.display = "inline-block";
                //alert.innerHTML = data;
                //console.log(data);
            }
        });
    }
</script>

