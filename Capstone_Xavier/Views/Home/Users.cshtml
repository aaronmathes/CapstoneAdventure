@using Capstone_Xavier.Models

@model List<CharacterModel>

@{
    ViewBag.Title = "User";
}

@*<div class="container">*@
    <div class="row">
        <div class="col-md-4 ml-md-auto d-flex justify-content-center">
            <h2>@ViewData["Title"]</h2>
        </div>
        <div class="col-md-4 d-flex justify-content-center" id="menu-button-style">
            <div class="nav-side">
                <div class="dropdown">
                    <button onclick="dropDown()" class="dropBtn">More</button>
                    <div id="myDropdown" class="dropdown-item">
                        <a onclick="location.href='@Url.Action("UserInfo", "User")'">Profile</a>
                        @{
                            string role = Session["Role"].ToString();

                            if (role == "1")
                            {
                                <a onclick="location.href='@Url.Action("Admin", "Admin")'">Admin</a>
                            }
                            else if (role == "3")
                            {
                                <a onclick="location.href='@Url.Action("Gamemaster", "Admin")'">GameMaster</a>
                            }
                        }
                        <a onclick="location.href='@Url.Action("Logout", "Home")'">Logout</a> @*this makes no extra spaces while @Html.ActionLink creates spaces*@
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="row justify-content-center" id="content" >
        <div class="row justify-content-center" style="margin-bottom: 1%;">
            <div class="col-sm-2 d-flex justify-content-center" style="margin-right: 1%; margin-left: 0;">
                <label style="height: fit-content;">Click a character's' name to play or click the "Create Character" button to create a new character!</label>
            </div>
            <div class="col-sm-2 d-flex justify-content-center" style="margin-left: 5%; padding-left: 3%;">
                <button class="btn-user" id="User" style="margin-left: 2%;"onclick="location.href='@Url.Action("createCharacter", "User", null)'">Create Character</button>
            </div>
        </div> 
    
        <div class="row justify-content-center">
             <div id="deleteAlert" style="display: none; font-size: 1.5rem; width: fit-content; height: fit-content; padding: 2%; background-color: palegoldenrod; background-image: linear-gradient(#ee3f3f, #961111); border-radius: 12px; ">

            </div>
            <div class="list">
                @foreach (CharacterModel ch in Model)
                    {
                <div id="@ch.id">
                    <div class="row align-items-center" style="margin-right: 0px; margin-left: 0px;">
                        <div class="col-sm-9">
                            <div class="row align-items-center">
                                <div class="col-sm-4">
                                    <div class="list-item-character">
                                        <p onclick="location.href='@Url.Action("Game", "Game", ch)'" style="cursor: pointer">@ch.name</p>
                                        <h6 class="sub-num">@ch.level</h6>
                                    </div>
                                </div>
                                <div class="col-sm-3">
                                    <button class="btn-change" id="@ch.id" onclick="location.href='@Url.Action("UpdateCharacter", "User", ch)'"></button>
                                    <button class="btn-remove" onclick="DeleteCharacterAlert('@ch.name', '@ch.id')"></button>

                                </div>
                                <div class="col-sm-5">
                                    <div class="info" id="class-info" @*style="margin-left: 2%;"*@>Class: @ch.className</div>
                                </div>
                            </div>

                        </div>
                        <div class="col-sm-3">
                            <div class="info">
                                Health: @ch.health / @ch.maxHP
                                <br>
                                Xp: @ch.xp / @ch.maxXp
                                <br>
                                Gold: @ch.gold
                            </div>
                        </div>
                    </div>
                    <hr>
                </div>

                    }
            </div>

        </div>
    </div>
@*</div>*@


<script type="text/javascript">
    function DeleteCharacterAlert(name, id) {
        $.ajax({
            url: "../../User/DeleteAlert",
            type: "Post",
            data: { name: name, id: id},
            cache: false,
            async: true,
            success: function (data) {
                var alert = document.getElementById("deleteAlert");
                /*console.log("deleteAlert");*/
                alert.style.display = "inline-block";
                alert.innerHTML = data;
                console.log(data);
            }
        });

    }

    function cancelDelete() {
        var alert = document.getElementById("deleteAlert");
        console.log(alert.innerHTML);
        alert.style.display = "none";

    }
    function removeCharacter(id) {
        console.log(id);
        //<!--var button = document.getElementById("delete");
        //var id = charId;
         @*button.onclick = "location.href='@Url.Action("RemoveCharacter", "User", Model[id] )'"-->*@
        @*button.onclick = "location.href='@Url.Action("RemoveCharacter", "User", cha )'"*@

        $.ajax({
            url: "../../User/RemoveCharacter",
            type: "Post",
            data: { characterId: id },
            cache: false,
            async: true,
            success: function (data) {
                console.log(id);
                var list = document.getElementById(data);
                list.style.display = "none";
                var alert = document.getElementById("deleteAlert");
                alert.style.display = "none";
                //var alert = document.getElementById("deleteAlert");
                ///*console.log("deleteAlert");*/
                //alert.style.display = "inline-block";
                //alert.innerHTML = data;
                //console.log(data);
            }
        });
    }
        </script>

